webpackJsonp([11],{XWS1:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=s("woOf"),n=s.n(i),a=s("Xxa5"),r=s.n(a),o=s("exGp"),c=s.n(o),u=s("BO1k"),d=s.n(u),l=s("0xDb"),v=["nickname","age","email","sex","signature"],f={nickname:"昵称",age:"年龄",email:"Email",sex:"性别",signature:"个性签名"},p="setting",g={oldPwd:"旧密码",newPwd:"新密码",reNewPwd:"确认新密码"},m={oldPwd:"请输入原始密码",newPwd:"请输入新密码",reNewPwd:"请确认新密码"},w={name:"Setting",data:function(){return{IMG_URL:"http://47.106.175.18:9000/",currentTab:p,settingList:v,listZHMap:f,userSetting:{},isModifying:{},pwdMap:g,pwdPlaceholder:m,pwdSetting:{oldPwd:"",newPwd:"",reNewPwd:""},fetching:!1}},computed:{userInfo:function(){return this.$store.state.user.userInfo},device:function(){return this.$store.state.device.deviceType}},methods:{setCurrentTab:function(e){this.currentTab=e},setUserSetting:function(e){var t=!0,s=!1,i=void 0;try{for(var n,a=d()(v);!(t=(n=a.next()).done);t=!0){var r=n.value;this.$set(this.userSetting,r,e[r]),this.$set(this.isModifying,r,!1)}}catch(e){s=!0,i=e}finally{try{!t&&a.return&&a.return()}finally{if(s)throw i}}},setModily:function(e,t){var s=this;for(var i in this.isModifying)this.isModifying.hasOwnProperty(i)&&(this.isModifying[i]=!1);if(e)if(this.isModifying[e]=t,t)this.$nextTick(function(){s.$refs[e]&&s.$refs[e][0].focus(),s.$refs[e]&&s.$refs[e][0].select()});else{var n=this.userInfo;this.setUserSetting(n)}},saveModify:function(e){var t=this;return c()(r.a.mark(function s(){var i,n,a;return r.a.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:if(t.userSetting[e]!==t.userInfo[e]){s.next=3;break}return t.setModily(void 0,!1),s.abrupt("return");case 3:return i={field:e,value:t.userSetting[e],userId:t.userInfo._id},t.fetching=!0,s.next=7,t.$http.updateUserInfo(i);case 7:if(n=s.sent,2e3!==n.data.status){s.next=18;break}return s.next=12,t.$http.getUserInfo(t.userInfo._id);case 12:a=s.sent,t.$store.dispatch("user/LOGIN",a.data.data),t.fetching=!1,t.$message({type:"success",message:"修改成功！"}),s.next=21;break;case 18:t.fetching=!1,t.setUserSetting(t.userInfo),t.$message({type:"error",message:"修改失败！"});case 21:t.setModily(void 0,!1);case 22:case"end":return s.stop()}},s,t)}))()},updateUserPwd:function(){var e=this;return c()(r.a.mark(function t(){var s,i,a;return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return s=n()({},e.pwdSetting,{userId:e.userInfo._id}),t.next=3,e.$http.updateUserPwd(s);case 3:i=t.sent,2e3===(a=i.data).status?e.$message({type:"success",message:a.msg}):e.$message({type:"warning",message:a.msg});case 6:case"end":return t.stop()}},t,e)}))()}},filters:{formatDate:function(e){return Object(l.h)(new Date(e))}},created:function(){var e=this.$store.state.user.userInfo;this.setUserSetting(e)}},h={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"setting-page",style:"Mobile"===e.device?{width:"95%"}:{}},[s("div",{staticClass:"header"},[s("div",{staticClass:"avatar"},[s("img",{attrs:{src:e.IMG_URL+e.userInfo.photo,alt:"",srcset:""}})]),e._v(" "),s("div",{staticClass:"info-list"},[s("div",{staticClass:"info-item"},[e._v("MessagerId："+e._s(e.userInfo.code))]),e._v(" "),s("div",{staticClass:"info-item"},[e._v("账号："+e._s(e.userInfo.name))]),e._v(" "),s("div",{staticClass:"info-item"},[e._v("注册时间："+e._s(e._f("formatDate")(e.userInfo.signUpTime)))]),e._v(" "),s("div",{staticClass:"info-item"},[e._v("登录时间："+e._s(e._f("formatDate")(e.userInfo.lastLoginTime)))])])]),e._v(" "),s("div",{staticClass:"body"},[s("div",{staticClass:"nav-list"},[s("span",{class:"setting"===e.currentTab?"operation-text isactive":"operation-text",on:{click:function(t){e.setCurrentTab("setting")}}},[e._v("个人资料")]),e._v(" "),s("span",{class:"password"===e.currentTab?"operation-text isactive":"operation-text",on:{click:function(t){e.setCurrentTab("password")}}},[e._v("\n        密码设置\n      ")])]),e._v(" "),s("div",{directives:[{name:"loading",rawName:"v-loading",value:e.fetching,expression:"fetching"}],staticClass:"content"},[s("ul",{directives:[{name:"show",rawName:"v-show",value:"setting"===e.currentTab,expression:"currentTab === 'setting'"}],staticClass:"user-setting-list"},e._l(e.settingList,function(t){return s("li",{key:t,staticClass:"setting-item"},[s("span",{staticClass:"title"},[e._v(e._s(e.listZHMap[t]))]),e._v(" "),s("div",{staticClass:"inp-box"},["sex"===t?[s("el-radio-group",{attrs:{disabled:!e.isModifying[t],size:"mini"},model:{value:e.userSetting[t],callback:function(s){e.$set(e.userSetting,t,s)},expression:"userSetting[item]"}},[s("el-radio-button",{attrs:{label:"0"}},[e._v("男")]),e._v(" "),s("el-radio-button",{attrs:{label:"1"}},[e._v("女")]),e._v(" "),s("el-radio-button",{attrs:{label:"3"}},[e._v("保密")])],1)]:[s("input",{directives:[{name:"model",rawName:"v-model",value:e.userSetting[t],expression:"userSetting[item]"}],ref:t,refInFor:!0,attrs:{type:"text",disabled:!e.isModifying[t]},domProps:{value:e.userSetting[t]},on:{input:function(s){s.target.composing||e.$set(e.userSetting,t,s.target.value)}}})]],2),e._v(" "),s("div",{staticClass:"action"},[s("span",{directives:[{name:"show",rawName:"v-show",value:!e.isModifying[t],expression:"!isModifying[item]"}],staticClass:"operation-text",on:{click:function(s){e.setModily(t,!0)}}},[e._v("\n              修改\n            ")]),e._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:e.isModifying[t],expression:"isModifying[item]"}],staticClass:"oper"},[s("span",{staticClass:"operation-text__danger",on:{click:function(s){e.saveModify(t)}}},[e._v("保存")]),e._v(" "),s("span",{staticClass:"operation-text__danger",on:{click:function(s){e.setModily(t,!1)}}},[e._v("取消")])])])])})),e._v(" "),s("ul",{directives:[{name:"show",rawName:"v-show",value:"password"===e.currentTab,expression:"currentTab === 'password'"}],staticClass:"user-password"},[e._l(e.pwdMap,function(t,i){return s("li",{key:i,staticClass:"pwd-item"},[s("span",{staticClass:"title"},[e._v(e._s(t))]),e._v(" "),s("div",{staticClass:"inp-box"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.pwdSetting[i],expression:"pwdSetting[key]"}],attrs:{placeholder:e.pwdPlaceholder[i],type:"text",autocomplete:"new-password",onfocus:"this.type = 'password'"},domProps:{value:e.pwdSetting[i]},on:{input:function(t){t.target.composing||e.$set(e.pwdSetting,i,t.target.value)}}})])])}),e._v(" "),s("div",{staticClass:"action"},[s("el-button",{attrs:{type:"primary"},on:{click:e.updateUserPwd}},[e._v("确认")])],1)],2)])])])},staticRenderFns:[]};var _=s("VU/8")(w,h,!1,function(e){s("hN5n")},null,null);t.default=_.exports},hN5n:function(e,t){}});
//# sourceMappingURL=11.b292b5b9a147564567e0.js.map