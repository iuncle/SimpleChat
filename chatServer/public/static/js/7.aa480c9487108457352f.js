webpackJsonp([7],{lXXB:function(e,t){},v6J1:function(e,t){},yPN8:function(e,t){},zr11:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=s("Xxa5"),i=s.n(a),n=s("Gu7T"),r=s.n(n),o=s("exGp"),c=s.n(o),l=s("0xDb"),d=s("kD8Z"),h=s("Dd8w"),u=s.n(h),p=s("NYxO"),v={props:["searchlist"],data:function(){return{IMG_URL:"http://47.106.175.18:9000/",friends:JSON.parse(window.localStorage.getItem("friends")),showAdditionMessage:!1,additionMessage:"",seleceItem:{},loading:!1}},methods:{showAdditionDialog:function(e){this.showAdditionMessage=!this.showAdditionMessage,this.seleceItem=e},sendApply:function(){var e=this;this.loading=!0,setTimeout(function(){e.loading=!1,e.showAdditionMessage=!1,e.additionMessage="",e.$alert("验证消息发送成功！","提示",{confirmButtonText:"确定",type:"warning"})},500);var t={roomid:this.sysUsers.filter(function(e){return"111111"===e.code})[0]._id+"-"+this.seleceItem._id,senderId:this.userInfo._id,senderName:this.userInfo.name,senderNickname:this.userInfo.nickname,senderAvatar:this.userInfo.photo,reveiverId:this.seleceItem._id,time:Object(l.j)(new Date),additionMessage:this.additionMessage,status:0,validateType:0};this.$socket.emit("sendValidateMessage",t)}},computed:u()({},Object(p.b)("app",{sysUsers:"sysUsers"}),Object(p.b)("user",{userInfo:"userInfo"}),{noMeSerchList:function(){var e=this;return this.searchlist.filter(function(t){return t._id!==e.userInfo._id})}})},f={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"custom-search-list-com"},e._l(e.noMeSerchList,function(t){return s("div",{key:t._id,staticClass:"wrapper"},[s("div",{staticClass:"details"},[s("el-avatar",{staticClass:"avatar",attrs:{shape:"square",src:e.IMG_URL+t.photo}}),e._v(" "),s("div",{staticClass:"info"},[s("p",{staticClass:"item primary-font nickname"},[s("router-link",{attrs:{to:"/user/"+t._id,tag:"span"}},[e._v("\n            "+e._s(t.nickname)+"\n          ")])],1),e._v(" "),s("p",{staticClass:"item secondary-font"},[e._v(e._s(t.signature))])])],1),e._v(" "),s("div",{staticClass:"operation"},[s("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-plus",disabled:(e.friends||[]).includes(t._id)},on:{click:function(s){e.showAdditionDialog(t)}}},[e._v("添加\n      ")]),e._v(" "),s("el-dialog",{attrs:{title:"附加消息",visible:e.showAdditionMessage,width:"60%"},on:{"update:visible":function(t){e.showAdditionMessage=t}}},[s("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}]},[s("el-input",{attrs:{type:"textarea",rows:2,placeholder:"请输入内容"},model:{value:e.additionMessage,callback:function(t){e.additionMessage=t},expression:"additionMessage"}})],1),e._v(" "),s("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{on:{click:function(t){e.showAdditionMessage=!1}}},[e._v("取 消")]),e._v(" "),s("el-button",{attrs:{type:"primary"},on:{click:function(t){e.sendApply()}}},[e._v("确 定")])],1)])],1)])}))},staticRenderFns:[]};var g=s("VU/8")(v,f,!1,function(e){s("v6J1")},null,null).exports,_={props:["searchlist"],data:function(){return{IMG_URL:"http://47.106.175.18:9000/",groups:JSON.parse(window.localStorage.getItem("groups")),showAdditionMessage:!1,additionMessage:"",seleceItem:{},loading:!1}},methods:{showAdditionDialog:function(e){this.showAdditionMessage=!this.showAdditionMessage,this.seleceItem=e},sendApply:function(){var e=this;this.loading=!0,setTimeout(function(){e.loading=!1,e.showAdditionMessage=!1,e.additionMessage="",e.$alert("验证消息发送成功！","提示",{confirmButtonText:"确定",type:"warning"})},500);var t={roomid:this.sysUsers.filter(function(e){return"111111"===e.code})[0]._id+"-"+this.seleceItem.holderUserId._id,senderId:this.userInfo._id,senderName:this.userInfo.name,senderNickname:this.userInfo.nickname,senderAvatar:this.userInfo.photo,reveiverId:this.seleceItem.holderUserId._id,groupId:this.seleceItem._id,time:Object(l.j)(new Date),additionMessage:this.additionMessage,status:0,validateType:1};this.$socket.emit("sendValidateMessage",t),console.log(t)}},computed:u()({},Object(p.b)("app",{sysUsers:"sysUsers"}),Object(p.b)("user",{userInfo:"userInfo"}),{noMeSerchList:function(){var e=this;return this.searchlist.filter(function(t){return t._id!==e.userInfo._id})}})},m={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"custom-search-list-com"},e._l(e.searchlist,function(t){return s("div",{key:t._id,staticClass:"wrapper"},[s("div",{staticClass:"details"},[s("el-avatar",{staticClass:"avatar",attrs:{shape:"square",src:e.IMG_URL+t.img}}),e._v(" "),s("div",{staticClass:"info"},[s("p",{staticClass:"item primary-font nickname"},[s("span",[e._v("\n            "+e._s(t.title)+"\n          ")])]),e._v(" "),s("p",{staticClass:"item secondary-font"},[e._v(e._s(t.desc))])])],1),e._v(" "),s("div",{staticClass:"operation"},[s("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-plus",disabled:(e.groups||[]).includes(t._id)},on:{click:function(s){e.showAdditionDialog(t)}}},[e._v("添加\n      ")]),e._v(" "),s("el-dialog",{attrs:{title:"附加消息",visible:e.showAdditionMessage,width:"60%"},on:{"update:visible":function(t){e.showAdditionMessage=t}}},[s("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}]},[s("el-input",{attrs:{type:"textarea",rows:2,placeholder:"请输入内容"},model:{value:e.additionMessage,callback:function(t){e.additionMessage=t},expression:"additionMessage"}})],1),e._v(" "),s("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{on:{click:function(t){e.showAdditionMessage=!1}}},[e._v("取 消")]),e._v(" "),s("el-button",{attrs:{type:"primary"},on:{click:function(t){e.sendApply()}}},[e._v("确 定")])],1)])],1)])}))},staticRenderFns:[]};var y=s("VU/8")(_,m,!1,function(e){s("yPN8")},null,null).exports,b=s("wA/d"),M={name:"Add",data:function(){return{searchKey:"",searchObjectMap:d.k,searchTypes:d.l,searchObject:"friend",searchType:"code",isFetch:!1,searchList:[],hasMore:!0,pageSize:7,page:0}},methods:{fetchUser:function(e,t){var s=this;return c()(i.a.mark(function a(){var n,o,c;return i.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,s.$http.preFetchUser(e);case 3:n=a.sent,2e3===(o=n.data).status&&(c=o.data,s.searchList=t?[].concat(r()(s.searchList),r()(c)):c,c.length<7?s.hasMore=!1:s.hasMore=!0),a.next=10;break;case 8:a.prev=8,a.t0=a.catch(0);case 10:return a.prev=10,s.isFetch=!1,a.finish(10);case 13:case"end":return a.stop()}},a,s,[[0,8,10,13]])}))()},fetchGroup:function(e,t){var s=this;return c()(i.a.mark(function a(){var n,o,c;return i.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,s.$http.preFetchGroup(e);case 3:n=a.sent,2e3===(o=n.data).status&&((c=o.data).forEach(function(e){e.isGroup=!0}),s.searchList=t?[].concat(r()(s.searchList),r()(c)):c,c.length<7?s.hasMore=!1:s.hasMore=!0),a.next=10;break;case 8:a.prev=8,a.t0=a.catch(0);case 10:return a.prev=10,s.isFetch=!1,a.finish(10);case 13:case"end":return a.stop()}},a,s,[[0,8,10,13]])}))()},handleTagClose:function(){this.searchKey="",this.fetch()},fetch:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],s=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!this.searchKey)return this.isFetch=!0,void setTimeout(function(){e.searchList=[],e.isFetch=!1},500);s&&(this.page=0,this.hasMore=!0),this.isFetch=!0;var a={type:this.searchType,q:this.searchKey,pageSize:this.pageSize,page:this.page};"friend"===this.searchObject?this.fetchUser(a,t):"group"===this.searchObject&&this.fetchGroup(a,t)},keyWordChange:Object(l.f)(function(){this.fetch(!1)},500),hanlerScroll:Object(l.f)(function(){var e=document.querySelector(".add-page");e.scrollTop+e.clientHeight+10>=e.scrollHeight&&this.hasMore&&(this.page++,this.fetch(!0))},500)},components:{userList:g,groupList:y,EmptySvg:b.a},mounted:function(){document.querySelector(".add-page").addEventListener("scroll",this.hanlerScroll)}},w={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"add-page"},[s("div",{staticClass:"header"},[s("div",{staticClass:"search-area"},[s("el-input",{attrs:{placeholder:"请输入内容","prefix-icon":"el-icon-search",maxlength:"20"},on:{input:e.keyWordChange},model:{value:e.searchKey,callback:function(t){e.searchKey=t},expression:"searchKey"}}),e._v(" "),s("el-select",{attrs:{placeholder:"请选择搜索对象"},on:{change:function(t){e.fetch(!1,!0)}},model:{value:e.searchObject,callback:function(t){e.searchObject=t},expression:"searchObject"}},e._l(e.searchObjectMap,function(e){return s("el-option",{key:e.id,attrs:{label:e.label,value:e.value}})})),e._v(" "),s("el-select",{attrs:{placeholder:"请选择"},on:{change:function(t){e.fetch(!1,!0)}},model:{value:e.searchType,callback:function(t){e.searchType=t},expression:"searchType"}},e._l(e.searchTypes[e.searchObject],function(e){return s("el-option",{key:e.id,attrs:{label:e.label,value:e.value}})}))],1),e._v(" "),s("div",{staticClass:"condition-list"},[s("el-tag",{attrs:{type:"danger"}},[e._v("当前搜索条件：")]),e._v(" "),e.searchKey?s("el-tag",{attrs:{closable:""},on:{close:e.handleTagClose}},[e._v(e._s(e.searchKey))]):e._e(),e._v(" "),e.searchObject?s("el-tag",[e._v(e._s(e.searchObject))]):e._e(),e._v(" "),e.searchType?s("el-tag",[e._v(e._s(e.searchType))]):e._e()],1)]),e._v(" "),s("div",{staticClass:"body"},[s("div",{directives:[{name:"loading",rawName:"v-loading",value:e.isFetch,expression:"isFetch"}],staticClass:"search-outcome"},[e.searchList.length?s("div",{staticClass:"description"},[e._v("\n        一共搜索到"+e._s(e.searchList.length)+"条结果\n      ")]):e._e(),e._v(" "),0===e.searchList.length?s("empty-svg",{staticClass:"no-data",attrs:{width:"200",height:"200"}}):e._e(),e._v(" "),"friend"===e.searchObject?s("user-list",{attrs:{searchlist:e.searchList}}):"group"===e.searchObject?s("group-list",{attrs:{searchlist:e.searchList}}):e._e(),e._v(" "),e.searchList.length&&!e.hasMore?s("div",{staticClass:"no-more"},[s("el-alert",{attrs:{title:"没有更多了...",type:"info",center:"","show-icon":"",closable:!1}})],1):e._e()],1)])])},staticRenderFns:[]};var I=s("VU/8")(M,w,!1,function(e){s("lXXB")},null,null);t.default=I.exports}});
//# sourceMappingURL=7.aa480c9487108457352f.js.map