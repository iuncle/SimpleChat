webpackJsonp([6],{"35e1":function(e,t){},czEw:function(e,t,o){e.exports=o.p+"static/img/canvas2.a921559.jpg"},eCqR:function(e,t){},lmfZ:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=o("Xxa5"),n=o.n(s),a=o("exGp"),i=o.n(a),r=o("Dd8w"),c=o.n(r),l=o("ys09"),d=o.n(l);var p=o("czEw"),u=o.n(p),f=o("0xDb"),v=o("9W+Z"),g={data:function(){return{endTime:(new Date).getFullYear()}}},h={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"copyright-cmp"},[t("p",{staticClass:"copyright-item"},[this._v("Copyright©2019-"+this._s(this.endTime))]),this._v(" "),t("p",{staticClass:"copyright-item"},[this._v("作者：chenchao")]),this._v(" "),t("p",{staticClass:"copyright-item"},[this._v("联系我：cAuth1218@163.com")])])},staticRenderFns:[]};var m=o("VU/8")(g,h,!1,function(e){o("eCqR")},null,null).exports,C=Math.ceil(10*Math.random()),w={name:"Login",data:function(){return{loginInfo:{account:"",password:"",cvCode:"",cvCodeTimestamp:"",avatar:JSON.parse(window.localStorage.getItem("userInfo")||"{}").photo||""},registerInfo:{account:"",password:"",rePassword:"",cvCode:"",avatar:"face/face"+C+".jpg"},cvCode:"",cvCodeing:!0,isLoginState:!0,bgUrl:d.a,showChooseAvatar:!1,IMG_URL:"http://47.106.175.18:9000/"}},computed:{device:function(){return this.$store.state.device.deviceType},avatar:function(){return this.IMG_URL+this.registerInfo.avatar}},methods:{login:function(){var e=this;if(!f.b.test(this.loginInfo.account))return this.$message.error("请输入3-6位由数字字母下划线组成的账号");if(!f.p.test(this.loginInfo.password))return this.$message.error("请输入6-64位由数字字母组成的密码");var t=window.returnCitySN?window.returnCitySN:{},o=c()({},this.loginInfo,{setting:{os:window.OSInfo,browser:window.Browser,ip:t.cip,country:t.cname}});this.$http.login(o).then(function(t){var o=t.data,s=o.status,n=o.data,a=o.msg;if(1002===s&&(e.loginInfo.cvCode="",e.getCVCode()),1007!==s)if(200===t.status&&1e3===s){e.$message.success("登录成功！"),e.$store.dispatch("user/LOGIN",n);var i=e.$router.currentRoute.query.redirect,r=i||"/chat/home";e.$router.replace(r)}else e.$message.error(a),1006!==s&&1007!==s||e.$confirm("你的"+a+"，如需恢复请联系管理员：ccdebuging@gmail.com","通知："+a,{type:"error"});else e.getCVCode()})},register:function(){var e=this;return f.b.test(this.registerInfo.account)?f.p.test(this.registerInfo.password)?this.registerInfo.password!==this.registerInfo.rePassword?this.$message.error("两次输入的密码不一致"):void this.$http.register(this.registerInfo).then(function(t){var o=t.data,s=o.msg,n=o.status,a=o.data;1005!==n?(e.$message.error(s),1002===n&&e.getCVCode()):1005===n&&(e.$alert("这是你的chat账号:"+a+"，你可以以此账号登录系统","注册成功"),e.changeState(!0))}):this.$message.error("请输入6-64位由数字字母组成的密码"):this.$message.error("请输入3-6位由数字字母下划线组成的账号")},getCVCode:function(){var e=this;this.cvCodeing=!0,this.$http.getCVCode().then(function(t){var o=t.data,s=o.data,n=(o.status,o.timestamp);e.cvCode=s,e.loginInfo.cvCodeTimestamp=n,e.$nextTick(function(){var t,o,s,n,a,i,r,c,l,d=e.isLoginState?e.$refs.loginCanvas:e.$refs.registerCanvas;t=e.cvCode,o=d,s=u.a,n=function(){e.cvCodeing=!1},a=t.split("").join(" "),r=(i=o).getContext("2d"),c=i.width/2,(l=new Image).src=s,l.width=120,l.width=40,l.onload=function(){n&&"function"==typeof n&&n();var e=r.createPattern(l,"repeat");r.fillStyle=e,r.fillRect(0,0,i.width,i.height),r.textAlign="center",r.fillStyle="\t#DC143C",r.font="26px Roboto Slab",r.setTransform(1,-.12,.2,1,0,0),r.fillText(a,c,40)}})})},changeState:function(e){this.isLoginState=e,this.getCVCode()},setShowChooseAvatar:function(e){this.showChooseAvatar=e},chooseAvatar:function(e){this.registerInfo.avatar=e}},components:{avatarChoose:v.a,copyRight:m},mounted:function(){var e=this;return i()(n.a.mark(function t(){return n.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:e.getCVCode(),e.$socket.emit("leave");case 2:case"end":return t.stop()}},t,e)}))()}},y={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"login-page",style:"background-image: url("+e.bgUrl+")"},[o("div",{staticClass:"ceshi",staticStyle:{"'marginTop'":"'30px'"}},[o("el-alert",{attrs:{closable:!1,"show-icon":"",title:"测试账号密码",description:"账号1：cc1218，密码1：123456 | 账号2：lt0623，密码2：123456",type:"success"}})],1),e._v(" "),o("transition",{attrs:{name:"fade"}},[e.showChooseAvatar?o("avatar-choose",{on:{close:function(t){e.setShowChooseAvatar(!1)},choose:e.chooseAvatar}}):e._e()],1),e._v(" "),o("div",{staticClass:"wrapper hor-ver-center",style:"Mobile"===e.device?{width:"90%"}:{}},[e.isLoginState?o("el-form",{staticClass:"login-form"},[o("div",{staticClass:"avatar"},[o("el-avatar",{attrs:{size:100,src:e.IMG_URL+e.loginInfo.avatar},on:{error:function(){return!0}}},[o("img",{attrs:{src:"https://cube.elemecdn.com/3/7c/3ea6beec64369c2642b92c6726f1epng.png"}})])],1),e._v(" "),o("el-form-item",[o("el-input",{attrs:{autocomplete:"new-password","prefix-icon":"el-icon-user",placeholder:"请输入账号"},on:{keydown:function(t){return"button"in t||!e._k(t.keyCode,"enter",13,t.key,"Enter")?e.login(t):null}},model:{value:e.loginInfo.account,callback:function(t){e.$set(e.loginInfo,"account",t)},expression:"loginInfo.account"}})],1),e._v(" "),o("el-form-item",[o("el-input",{attrs:{autocomplete:"new-password",type:"password","prefix-icon":"el-icon-lock",placeholder:"请输入密码"},model:{value:e.loginInfo.password,callback:function(t){e.$set(e.loginInfo,"password",t)},expression:"loginInfo.password"}})],1),e._v(" "),o("el-form-item",{staticClass:"cv-code"},[o("el-input",{staticClass:"cv-code-inp",attrs:{autocomplete:"on","prefix-icon":"el-icon-lock",placeholder:"验证码(不区分大小写)"},nativeOn:{keydown:function(t){return"button"in t||!e._k(t.keyCode,"enter",13,t.key,"Enter")?e.login(t):null}},model:{value:e.loginInfo.cvCode,callback:function(t){e.$set(e.loginInfo,"cvCode",t)},expression:"loginInfo.cvCode"}}),e._v(" "),o("canvas",{directives:[{name:"show",rawName:"v-show",value:!e.cvCodeing,expression:"!cvCodeing"}],ref:"loginCanvas",attrs:{width:"120",height:"40"},on:{click:e.getCVCode}}),e._v(" "),o("span",{directives:[{name:"show",rawName:"v-show",value:e.cvCodeing,expression:"cvCodeing"}],staticStyle:{width:"200px"}},[e._v("获取中...")])],1),e._v(" "),o("el-form-item",[o("el-button",{staticClass:"login-btn",attrs:{type:"primary"},on:{click:e.login}},[e._v("登录")]),e._v(" "),o("span",[e._v("没有账号？"),o("span",{staticClass:"operation-text",staticStyle:{display:"inline"},on:{click:function(t){e.changeState(!1)}}},[e._v("注册")])])],1)],1):e._e(),e._v(" "),e.isLoginState?e._e():o("el-form",{staticClass:"register-form"},[o("div",{staticClass:"avatar",on:{click:function(t){e.setShowChooseAvatar(!0)}}},[o("img",{staticStyle:{"border-radius":"50%"},attrs:{src:e.avatar,alt:"",srcset:"",width:"100",height:"100"}}),e._v(" "),o("span",{staticClass:"secondary-font",staticStyle:{display:"inline-block","margin-bottom":"5px"}},[e._v("\n            点击头像切换头像\n          ")])]),e._v(" "),o("el-form-item",[o("el-input",{attrs:{type:"text",autocomplete:"new-password","prefix-icon":"el-icon-user",placeholder:"请输入账号"},model:{value:e.registerInfo.account,callback:function(t){e.$set(e.registerInfo,"account",t)},expression:"registerInfo.account"}})],1),e._v(" "),o("el-form-item",[o("el-input",{attrs:{type:"text",autocomplete:"new-password",onfocus:"this.type = 'password'","prefix-icon":"el-icon-lock",placeholder:"请输入密码"},model:{value:e.registerInfo.password,callback:function(t){e.$set(e.registerInfo,"password",t)},expression:"registerInfo.password"}})],1),e._v(" "),o("el-form-item",[o("el-input",{attrs:{type:"text",autocomplete:"new-password",onfocus:"this.type = 'password'","prefix-icon":"el-icon-lock",placeholder:"请确认密码"},model:{value:e.registerInfo.rePassword,callback:function(t){e.$set(e.registerInfo,"rePassword",t)},expression:"registerInfo.rePassword"}})],1),e._v(" "),o("el-form-item",{staticClass:"cv-code"},[o("el-input",{staticClass:"cv-code-inp",attrs:{"prefix-icon":"el-icon-lock",placeholder:"验证码(不区分大小写)"},model:{value:e.registerInfo.cvCode,callback:function(t){e.$set(e.registerInfo,"cvCode",t)},expression:"registerInfo.cvCode"}}),e._v(" "),o("canvas",{ref:"registerCanvas",attrs:{width:"120",height:"40"},on:{click:e.getCVCode}})],1),e._v(" "),o("el-form-item",{staticClass:"oper"},[o("el-button",{staticClass:"login-btn",attrs:{type:"primary"},on:{click:e.register}},[e._v("注册")]),e._v(" "),o("span",[e._v("已有账号？"),o("span",{staticClass:"operation-text",staticStyle:{display:"inline"},on:{click:function(t){e.changeState(!0)}}},[e._v("登录")])])],1)],1)],1)],1)},staticRenderFns:[]};var _=o("VU/8")(w,y,!1,function(e){o("35e1")},null,null);t.default=_.exports},ys09:function(e,t,o){e.exports=o.p+"static/img/ocean1.9f751a7.jpg"}});
//# sourceMappingURL=6.730954e66ca3c0a8c6d4.js.map