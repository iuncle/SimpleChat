webpackJsonp([8],{"+FZN":function(t,e){},pXQy:function(t,e){},yXTY:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=a("Xxa5"),n=a.n(s),i=a("woOf"),o=a.n(i),r=a("exGp"),c=a.n(r),l=a("9wvJ"),u=a("9WPK"),g=a("kD8Z"),v={data:function(){return{qiniuToken:"",categoryList:[],currentCate:{},tagList:[],selectedTags:[],blogDesc:"",blogCover:""}},methods:{getBlogCategory:function(){var t=this;return c()(n.a.mark(function e(){var a,s;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.$http.getBlogCategory();case 2:a=e.sent,2e3===(s=a.data).status&&(t.categoryList=s.data,t.currentCate=t.categoryList[0],t.$emit("change","category",t.currentCate),t.getBlogTag());case 5:case"end":return e.stop()}},e,t)}))()},getBlogTag:function(){var t=this;return c()(n.a.mark(function e(){var a,s;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.$http.getBlogTag(t.currentCate._id);case 2:a=e.sent,2e3===(s=a.data).status&&(t.tagList=s.data);case 5:case"end":return e.stop()}},e,t)}))()},setCurrentCate:function(t){this.currentCate=t,this.$emit("change","category",this.currentCate),this.getBlogTag()},selectTag:function(t){var e=this.selectedTags||[],a=e.findIndex(function(e){return e._id===t._id});-1!==a?e.splice(a,1):e.push(t),this.$emit("change","tags",this.selectedTags)},setCover:function(t){this.blogCover=t,this.$emit("change","cover",this.blogCover)},getCover:function(t){if(console.log(t),"complete"===t.status){var e=g.j+t.data.key;this.setCover(e)}},setShow:function(t){this.$emit("setShow",t)},publish:function(){this.$emit("publish")}},watch:{blogDesc:function(t){this.$emit("change","desc",this.blogDesc)}},components:{partTitle:l.a,uploadImg:u.a},mounted:function(){var t=this;this.getBlogCategory(),this.$http.getQiniuToken().then(function(e){var a=e.data;t.qiniuToken=a.data})}},h={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"blog-meta-dialog-cmp all0"},[a("div",{staticClass:"dialog-content hor-ver-center"},[a("i",{staticClass:"el-icon-close p-r-t",on:{click:function(e){t.setShow(!1)}}}),t._v(" "),a("div",{staticClass:"meta-list"},[a("div",{staticClass:"meta-item"},[a("part-title",{attrs:{text:"文章描述"}}),t._v(" "),a("el-input",{attrs:{placeholder:"请输入文章描述",type:"textarea"},model:{value:t.blogDesc,callback:function(e){t.blogDesc=e},expression:"blogDesc"}})],1),t._v(" "),a("div",{staticClass:"meta-item cover"},[a("part-title",{attrs:{text:"文章封面"}}),t._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:t.blogCover,expression:"blogCover"}],staticClass:"img-content"},[a("i",{staticClass:"el-icon-close",attrs:{title:"删除封面"},on:{click:function(e){t.setCover("")}}}),t._v(" "),a("img",{staticClass:"img",attrs:{src:t.blogCover,alt:""}})]),t._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:!t.blogCover,expression:"!blogCover"}],staticClass:"upload-cover"},[a("uploadImg",{attrs:{useType:"slot",getStatus:t.getCover,token:t.qiniuToken},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{type:"primary",icon:"el-icon-upload"},on:{click:e.trigger}},[t._v("上传博客封面")])]}}])})],1)],1),t._v(" "),a("div",{staticClass:"meta-item cate-tag"},[a("part-title",{attrs:{text:"文章分类及标签"}}),t._v(" "),a("div",{staticClass:"category item"},t._l(t.categoryList,function(e){return a("span",{key:e._id,class:t.currentCate._id===e._id?"cate-item isactive":"cate-item",on:{click:function(a){t.setCurrentCate(e)}}},[t._v("\n            "+t._s(e.name)+"\n          ")])})),t._v(" "),a("div",{staticClass:"tag item"},t._l(t.tagList,function(e){return a("span",{key:e._id,class:t.selectedTags.includes(e.name)?"tag-item isselected":"tag-item",on:{click:function(a){t.selectTag(e)}}},[a("el-tag",{attrs:{type:"success",effect:t.selectedTags.includes(e.name)?"dark":"plain"}},[t._v(t._s(e.name))])],1)})),t._v(" "),a("div",{staticClass:"tag item"},[t._v("\n          已选标签：\n          "),t._l(t.selectedTags,function(e){return a("span",{key:e,staticClass:"tag-item"},[a("el-tag",{attrs:{size:"small",closable:""},on:{close:function(a){t.selectTag(e)}}},[t._v(t._s(e.name))])],1)})],2)],1)]),t._v(" "),a("div",{staticClass:"footer"},[a("el-button",{attrs:{type:"text"},on:{click:function(e){t.setShow(!1)}}},[t._v("取消")]),t._v(" "),a("el-button",{attrs:{type:"info"}},[t._v("存为草稿")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:t.publish}},[t._v("发表博客")])],1)])])},staticRenderFns:[]};var m={name:"Editor",data:function(){return{showDialog:!1,blogParams:{category:"",tags:[],cover:"",title:"",content:"",desc:""}}},computed:{userInfo:function(){return this.$store.state.user.userInfo}},methods:{setBlogParams:function(){for(var t in this.blogParams)this.blogParams.hasOwnProperty(t)&&(this.blogParams[t]="")},publish:function(){var t=this;return c()(n.a.mark(function e(){var a,s,i;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=o()({},t.blogParams,{authorId:t.userInfo._id}),e.next=3,t.$http.publishBlog(a);case 3:s=e.sent,i=s.data,t.setBlogParams(),2e3===i.status&&t.$confirm("恭喜你，发布成功！","提示",{confirmButtonText:"回到列表",cancelButtonText:"再写一篇",type:"warning"}).then(function(){t.$router.go(-1)}).catch(function(){});case 7:case"end":return e.stop()}},e,t)}))()},metaChange:function(t,e){this.blogParams[t]=e},setShowDialog:function(t){var e=this.blogParams;e.title&&e.content?this.showDialog=t:this.$message({type:"error",message:"信息未填写完整！"})}},components:{metaDialog:a("VU/8")(v,h,!1,function(t){a("+FZN")},null,null).exports}},d={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"editor-blog"},[a("div",{staticClass:"header"},[a("el-input",{model:{value:t.blogParams.title,callback:function(e){t.$set(t.blogParams,"title",e)},expression:"blogParams.title"}}),t._v(" "),a("el-button",{staticClass:"publish-btn",attrs:{type:"primary"},on:{click:function(e){t.setShowDialog(!0)}}},[t._v("发表博客")])],1),t._v(" "),a("div",{staticClass:"editor-area"},[a("mavon-editor",{staticClass:"container",model:{value:t.blogParams.content,callback:function(e){t.$set(t.blogParams,"content",e)},expression:"blogParams.content"}})],1),t._v(" "),a("meta-dialog",{directives:[{name:"show",rawName:"v-show",value:t.showDialog,expression:"showDialog"}],on:{change:t.metaChange,setShow:t.setShowDialog,publish:t.publish}})],1)},staticRenderFns:[]};var p=a("VU/8")(m,d,!1,function(t){a("pXQy")},null,null);e.default=p.exports}});
//# sourceMappingURL=8.7214a850e8913b6075c8.js.map